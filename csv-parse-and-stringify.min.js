const CSV=class{static parse(string){if("string"!=typeof string)return console.error("Type Error: The argument you set isn't string."),[[]];const rtnArray=string.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n"),marge_status={marge:!1,row:-1,colmun:-1};for(let i=0;i<rtnArray.length;i++){rtnArray[i]=rtnArray[i].split(",");for(let j=0;j<rtnArray[i].length;j++){let cell_value=rtnArray[i][j];if(i===rtnArray.length-1&&0===j&&""===cell_value){rtnArray.splice(i,1);break}marge_status.marge||'"'!==cell_value[0]?marge_status.marge&&('"'===(cell_value=cell_value.replace(/"{2}/g,'"'))[cell_value.length-1]&&(marge_status.marge=!1,cell_value=cell_value.slice(0,-1)),rtnArray[marge_status.row][marge_status.colmun]+=(marge_status.row===i?",":"\r\n")+cell_value,rtnArray[i].splice(j--,1)):('"'!==cell_value[cell_value.length-1]?(marge_status.marge=!0,marge_status.row=i,marge_status.colmun=j,cell_value=cell_value.slice(1)):cell_value=cell_value.slice(1,-1),rtnArray[i][j]=cell_value.replace(/"{2}/g,'"'))}}for(let i=0;i<rtnArray.length;i++)0===rtnArray[i].length&&rtnArray.splice(i--,1);return rtnArray}static stringify(array){if(!Array.isArray(array))return console.error("Type Error: The argument you set isn't array."),"";const rtnCSV=new Array;for(let i=0;i<array.length;i++){if(!Array.isArray(array[i]))return console.error("Type Error: A row of the argument you set isn't array."),"";rtnCSV[i]=new Array;for(let j=0;j<array[i].length;j++){let cell_value=array[i][j]||"";const includesNewLine=cell_value.indexOf("\r\n")>-1||cell_value.indexOf("\r")>-1||cell_value.indexOf("\n")>-1,includesComma=cell_value.indexOf(",")>-1,includesQuote=cell_value.indexOf('"')>-1;includesQuote&&(cell_value=cell_value.replace(/"/g,'""')),rtnCSV[i][j]=includesNewLine||includesComma||includesQuote?`"${cell_value}"`:cell_value}rtnCSV[i]=rtnCSV[i].join(",")}return rtnCSV.join("\r\n")}};